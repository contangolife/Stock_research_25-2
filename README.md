Stock Research — HMM 기반 시장 판단 & 레짐 스위칭 전략
=

상태
----
- WIP 문서: 내용 추후 상세 정리 예정
- 코드 안정화 우선: **코드 파일 건들지 말 것**
- 단일 소스: **HMM_final** 이 최종 실행/결과 확인용 파일
  (해당 파일에서 결과 확인 + 필요한 함수만 따라 작성해서 사용)

핵심 요지
---------
- HMM으로 시장 레짐(상태) 추정 → 레짐에 맞는 전략 선택/스위칭
- 백테스트는 트레일링 스탑/초기 하드스톱/체결 모드 등 현실성 반영
- 성과 분석(Sharpe/CAGR/MaxDD) + 전략/레짐 기여도(Attribution) 확인

프로세스(개요)
--------------
1) 데이터 준비
   - 필수: DatetimeIndex, Close
   - 권장: High/Low(스탑 트리거 정확도)
   - 결측/중복/영업일 정렬

2) 레짐 추정(HMM)
   - 수익률/변동성/자기상관 등 피처 → HMM/ MS-AR(1) 학습
   - 상태별 통계 해석 후 레이블링(추세/평균회귀/랜덤워크 등)

3) 레짐별 전략 매핑
   - 추세형 레짐 → Momentum
   - 횡보/반전형 → MeanReversion
   - 불확실/랜덤워크 → 0(관망) 또는 저위험 전략

4) 백테스트 실행
   - 체결 시차(exec_shift=1 권장), 수수료/슬리피지(bps), 리버설 비용(턴오버×2)
   - 트레일링 스탑(ATR/퍼센트), 초기 하드스톱, 무장(arm) 조건
   - 체결가 모드: close | stop | next_open (실전 가정에 맞게 선택)

5) 시각화 & 성과분석
   - 가격 + 레짐 셰이딩 + 엔트리/청산/리버설 + 스탑 포인트
   - 누적수익(Net/Gross) & Buy&Hold 비교
   - 전략/레짐 기여도(Attribution) 표로 성과 분해

사용 가이드(간단)
-----------------
- **HMM_final** 파일만 열어서 실행 → 결과(그림/표) 확인
- 필요한 함수는 HMM_final에 있는 것을 기준으로 복사/호출
- 파라미터 변경 시: HMM_final 내부 셀에서만 조정(다른 코드 파일 변경 금지)

주의/금지 사항
--------------
- 저장소 내 다른 파이썬 모듈/클래스 파일 **수정 금지**
- 레짐 산출 로직과 전략 매핑은 HMM_final 내 셀 순서를 유지해 실행
- High/Low 없이 stop 모드 기대치 과다 설정 금지(스탑 판정 정확도 저하)

TODO(차후 정리 항목)
--------------------
- 레짐 산출 파이프라인 문서화(피처/하이퍼파라미터/전이행렬)
- 전략 파라미터 표준값 및 민감도 분석
- 체결/비용 시나리오별 성과 비교(미국/한국, ETF/주식)
- Attribution 리포트 템플릿(표 + 그림) 자동화
- 결과 리포트(요약지표/그림) 자동 저장 스크립트

폴더 가이드(예시)
-----------------
project_root/
├─ HMM_final                # 최종 실행/분석 파일(유일한 편집 지점)
├─ data/                    # 원천/전처리 데이터
├─ reports/                 # 그림/표/리포트 산출물
└─ (기타 코드 파일은 참고만, 수정 금지)

문의
----
- 변경/추가 요청은 카톡으로, **HMM_final 외 수정 금지** 원칙 준수
